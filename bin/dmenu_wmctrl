#!/bin/sh

set -e

# 環境変数の設定
export LC_ALL=C
export LANG=C

# 引数をargsに代入
args="${*}"

# argsの有無を判定,引数があれば真,なければ偽
if [ -n "${args}" ] ; then

	# 真の場合は引数をdmenuに渡す
	dmenu_custom="dmenu ${args}"

else

	# 偽の場合は予め設定された引数をdmenuに渡す
	dmenu_custom='dmenu -p dmenu_wmctrl -i -l 20 -sb black -sf grey -fn monospace'

fi

set -u

# wmctrlがシステム内に存在するかを確認,あれば真,なければ偽
if type wmctrl > /dev/null 2>&1 ; then

	# ウィンドウ一覧を"wmctrl"で出力,選択されたウィンドウを変数に代入
	selected_window=$(wmctrl -l | cut -d" " -f5- | ${dmenu_custom})

	# 選択されたウィンドウに切り替え
	wmctrl -a "${selected_window}"

else

	# 偽の場合はエラーメッセージを表示,dmenuからの出力を捨てる
	echo "Error: please install \"wmctrl\"" | dmenu -p "dmenu_wmctrl" > /dev/null

fi 

