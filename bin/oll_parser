#!/bin/sh -eu

# ====== 変数の設定 ======
# ロケールの設定
export LC_ALL=C
export LANG=C

# GNU coreutilsの挙動をPOSIXに準拠
export POSIXLY_CORRECT=1
# ====== 変数の設定ここまで ======


# 標準入力の有無を確認,あれば真,無ければ偽
if [ -p /dev/stdin ] ; then

	# 真の場合は標準入力を変数に代入,非対話的に処理
	input_string=$(cat - )

    echo "${input_string}" |
  
	# シフトJISからUTF-8に変換
	iconv -f sjis -t utf8 |

	# 不要な部分の削除
	sed -e '1d' -e "s/\"=\"//g" -e "s/\"\"//g" -e "s/\"//g" |

	# 行末の","の削除
	cut -d"," -f1-16
	
# 偽の場合は引数の数を確認,0以外で真
elif [ "${#}" != 0 ] ; then

	# 第1引数を変数に代入
	args="${1}"

	# シフトJISからUTF-8に変換
	cat < "${args}" | iconv -f sjis -t utf8 |

	 sed -e '1d' -e "s/\"=\"//g" -e "s/\"\"//g" -e "s/\"//g" | cut -d"," -f1-16

else

	# 偽の場合はメッセージを標準エラー出力に表示
	echo "please stdin!" 1>&2

fi
